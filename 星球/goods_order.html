<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/font.css"/>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		<link rel="stylesheet" type="text/css" href="css/swiper.css"/>
		<script src="js/jquery-3.4.1.min.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			body{height: 100vh;}
			.layui-layer-btn{display: flex;}
			.layui-layer-btn a{width: 50%;text-align: center;}
			#pay_pwd .maskBox .titleText,#pay_pwd .maskBox .contentText,#pay_pwd .maskBox .pwdInput,#pay_pwd .maskBox .fakeBox input{color: #000;}
		</style>
	</head>
	<body>
		<h1 class="h1">
			<button class="iconfont icon-xiangzuo1" onclick="javascript:history.back(-1);"></button>
	    	<p>提交订单</p>
		</h1>
		<div class="submitOrder">
			<a href="address.html" class="order_a">
				<div class="info">
					<img src="img/goods_addr.png" class="goods_addr"/>
					<div class="info_details">
						<div class="person">
							<div class="l">
								<div class="l_r">
									<span>范文文</span>
								</div>
								<div class="l_r">
									<span class="iphone">188 8888 8888</span>
								</div>
							</div>
						</div>
						<div class="chooseAddress">
							<p class="l_r"><span class="addr">深圳市 南山区 深南大道9028号益田假日广场B1层(下沉式广场)</span></p>
						</div>
					</div>
					<!--<div>
						<div class="person">
							<p>暂无收货地址~~~</p>
						</div>
						<div class="chooseAddress">
							<p>请前往添加地址~~~</p>
						</div>
					</div>-->
					<img src="img/info_next.png" class="more"/>
				</div>
			</a>
			
			
			<div class="pay-pro">
				<div class="pay-info">
					<img src="img/goods_1.png" class="img">
					<div class="pay-div pay_bo">
						<div class="name">格子连衣裙女喇叭长袖 2020秋冬季新款复古V领气质收腰显瘦大…</div>
						<p class="tips">XL</p>
						<div class="shue">
						<p class="price"><b>￥</b><span>1399.00</span></p> <p class="Num">X<i class="num_c">1</i></p>
						</div>
					</div>
				</div>		
				<div class="pay-info">
					<img src="img/goods_1.png" class="img">
					<div class="pay-div">
						<div class="name">格子连衣裙女喇叭长袖 2020秋冬季新款复古V领格子连衣裙女喇叭长袖 2020秋冬季新</div>
						<p class="tips">XL</p>
						<div class="shue">
						<p class="price"><b>￥</b><span>1399.00</span></p> <p class="Num">X<i class="num_c">1</i></p>
						</div>
					</div>
				</div>	
				
				<div class="yunfei">
					<p class="l">配送方式</p>
					<p class="r">普通配送 快递包邮</p>
				</div>
				<div class="yunfei">
					<p class="l">订单备注</p>
					<p class="r input_box">
						<input type="text" value="" placeholder="选填，最多留言50字" />
					</p>
				</div>
				<div class="yunfei">
					<p class="r">共2件，小计：<i class="active">￥799.00</i></p>
				</div>
			</div>
			
			<!--占位，防止被底部遮住-->
			<div class="height1"></div>
			<div class="sum">
				<div class="r">
					<span class="price">合计：<b>￥</b><span class="price">399.00</span></span>
					<span class="ze">购买赠送：399QSC</span>
				</div>
				<button class="a jiesuan">立即购买</button>
			</div>
		</div>
	
	<style type="text/css">
    	.layui-layer.layui-layer-page{width: 65%;left: 0 !important;right: 0;margin: auto;}
    	#pay_pwd{padding: 10px;margin: 8% auto 0;display: block;border: 1px solid #eee;width: 90%;}
    </style>
    <!-- 放支付密码 -->
    <div id="pay_box" style="display: none;">
		<input type="password" placeholder="请输入安全密码" name="pay_pwd" id="pay_pwd" value="" />
	</div>
		
	<style type="text/css">
		.pay_mo{background: rgba(0,0,0,0.5);width: 100vw;height: 100vh;display: none;position: fixed;top:0px;z-index: 1;}
		.pay_mo .middle_box{width: 100%;position: absolute;bottom: 0px;}
		.pay_mo .middle_box{bottom: 15vh !important;}
		.pay_close{position: absolute;right: 6%;top: 3vh;z-index: 9;width: 6%;}
		.pay_close img{width: 100%;}
	</style>	
	<!-- 支付方式 -->
	<div class="pay_mo">
		<div class="middle_box">
			<i class="pay_close"><img src="img/close.png"/></i>
			<div class="big_box">
				<b class="pay_price">￥399.90</b>
				<i class="pay_txt">支付金额</i>
				<div class="tt_div">
					<span>请选择交易方式</span>
				</div>
				<div class="pay_box">
					<ul>
						<li>
							<div class="pay_l">
								<img src="img/pay_1.png"/>
								<i>现金券</i>
							</div>
							<div class="label">
								<input type="radio" class="check" name="type" checked="checked" value="1"/>
							</div>
						</li>
						<li>
							<div class="pay_l">
								<img src="img/pay_2.png"/>
								<i>在线支付</i>
							</div>
							<div class="label">
								<input type="radio" class="check" name="type" value="2"/>
							</div>
						</li>
					</ul>
				</div>
				<div class="anniu">立即支付</div>
			</div>
		</div>
	</div>
	
	</body>
	<script src="layer/layer.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/check.js" type="text/javascript" charset="utf-8"></script>
	<script>
		/*点击加一*/
		$('.btn2').click(function(){
			$(this).prev('.number').html(parseInt($(this).prev('.number').html())+1);
		})
		/*点击减一*/
		$('.btn1').click(function(){
			if($(this).next('.number').html()==1)
				$(this).next('.number').html(1);
			else
				$(this).next('.number').html(parseInt($(this).next('.number').html())-1);	
		})
		
		$(".pay_close").click(function(){$(".pay_mo").hide();})
        
        $('.jiesuan').click(function(){$(".pay_mo").show();})
		
		$('.anniu').click(function(){
            layer.open({title: '请输入安全密码', btn: ['确认','取消'],type:1, content: $('#pay_box'),
				btn1:function(){
					var payment = $("#pay_pwd").val();
					console.log("payment"+payment);
					if(payment == ""){
						layer.msg("请输入安全密码");
						return false;
					}
					var pay_type = $("input[name='type']:checked").val();
					console.log("pay_type"+pay_type);
                    var address_id = $('input[name="address_id"]').val();
                    var remarks = $('input[name="remarks"]').val();
                    var data = {goods: goods,address_id:address_id,remarks:remarks ,payment: payment};
                    $.ajax({
                        type: "POST",
                        url: "",
                        data: {data: data},
                        dataType: 'json',
                        success: function(res) {
                            console.log(res);
                            if (res.result == 0) {
                                layer.msg("支付成功",function () {
                                    location.href = '/order/index';
                                });
                                layer.closeAll();
                                // setTimeout(function() {
                                //     window.location.reload(); //刷新当前页面.
                                // }, 2000)
                            }else {
                                layer.msg(res.msg);
                            }
                        }
                    })
				},
				btn2:function(){
					layer.closeAll();
				}
			});
		})	
		
	</script>
</html>
